(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1931],{80496:function(e,t,n){Promise.resolve().then(n.bind(n,68157))},87138:function(e,t,n){"use strict";n.d(t,{default:function(){return i.a}});var r=n(231),i=n.n(r)},68157:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return b}});var r=n(57437),i=n(87138),s=n(56800),a=n.n(s),o=n(2265),c=n(75897),u=n(38517),l=n(63536),d=n(78068),h=n(16463),f=n(44447),g=n(99441),p=n(84554),m=n(45129),y=n(70101),v=n(87212);function b(){let[e,t]=(0,g.FV)(p.g),{toast:n}=(0,d.pm)(),[s,b]=(0,o.useState)(!1),{setToken:x,setAccount:w}=(0,l.k)(),I=(0,h.useRouter)(),[N,j]=(0,y.Z)(),[k,E]=(0,o.useState)(!1),{address:S,chainId:_}=(0,v.m)(),A=(0,o.useMemo)(()=>null!=e?e:"/dashboard",[e]),C=async()=>{try{b(!0);let{message:e,signature:t}=await u.a.signByEIP4361("Welcome to Zytron!");if(e&&t){let n=(await m.Z.login({message:e,signature:t})).token;x(n),E(!0)}else b(!1)}catch(i){b(!1),console.error("Error signing in with VIEM:",i);let{code:e,message:t}=i||{};n({variant:"destructive",title:null!=e?e:"Failed",description:(0,r.jsx)("p",{className:"text-[14px]",children:null!=t?t:"Failed"})})}};return(0,o.useLayoutEffect)(()=>{N&&j&&(t(void 0),I.push(A))},[N,A]),(0,o.useEffect)(()=>{k&&S&&_&&(w(S,_),t(void 0))},[k,S,_]),(0,r.jsx)("div",{className:a()("w-full h-[800px] flex items-center justify-center",{"opacity-30 pointer-events-none":!j}),children:(0,r.jsxs)("div",{className:"flex items-center justify-center flex-col max-w-lg w-full space-y-8 p-14 shadow-lg rounded-lg bg-slate-800",children:[(0,r.jsx)(i.default,{href:"/",children:(0,r.jsx)("img",{src:"/nav/logo_dark.png",width:185,height:40,alt:f.DJ})}),(0,r.jsx)("h1",{className:"text-2xl font-bold mb-6 text-center",children:"Welcome to Zytron"}),(0,r.jsx)(c.z,{className:"w-[150px]",onClick:C,isLoading:s,disabled:s,children:"Connect Wallet"})]})})}},75897:function(e,t,n){"use strict";n.d(t,{z:function(){return l}});var r=n(57437),i=n(2265),s=n(71538),a=n(12218),o=n(49354);n(10621);var c=(0,i.memo)(()=>(0,r.jsx)("span",{className:"inline-block animate-ellipsis ml-[4px]"}));let u=(0,a.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-[#4669F8] text-[#4669F8] font-light text-[18px] bg-transparent opacity-100 hover:opacity-80 transition:opacity",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"font-light text-[18px] hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=i.forwardRef((e,t)=>{let{className:n,variant:a,size:l,asChild:d=!1,isLoading:h,onClick:f,disabled:g,...p}=e,m=d?s.g7:"button",[y,v]=(0,i.useState)(!1),b=(0,i.useCallback)(e=>{f&&(v(!0),setTimeout(()=>{v(!1)},1e3),f(e))},[f]);return(0,r.jsxs)(m,{className:(0,o.cn)(u({variant:a,size:l,className:n})),ref:t,onClick:b,disabled:g||y,...p,children:[p.children,h&&(0,r.jsx)(c,{})]})});l.displayName="Button"},49354:function(e,t,n){"use strict";n.d(t,{cn:function(){return s}});var r=n(44839),i=n(96164);function s(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,i.m6)((0,r.W)(t))}},38517:function(e,t,n){"use strict";n.d(t,{a:function(){return c}});var r=n(99112),i=n(21019),s=n(66594),a=n(43665);class o{init(){if("ethereum"in window){let e=window.ethereum;this.provider=e}else window.open("https://metamask.io/","_blank")}getPublicKey(e){return(0,s.L)(e).publicKey}getAccount(e){return(0,s.L)(e).address}getAddress(e){return(0,r.K)(e)}async connect(){if(!this.provider)return!1;let e=await this.provider.request({method:"eth_requestAccounts"}),t=await this.provider.request({method:"eth_chainId",params:[]});return this.chainId=(0,i.ly)(t),this.address=(0,r.K)(e[0]),!0}async getNonce(){return parseInt(await this.provider.request({method:"eth_getTransactionCount",params:[this.address,"latest"]}),16).toString()}async getBlockNumber(){return parseInt(await this.provider.request({method:"eth_blockNumber",params:[]}),16).toString()}async initAndConnect(){this.init(),await this.connect()}async signByEIP4361(e){await this.initAndConnect();let t=await this.getBlockNumber(),n=this.chainId;if(console.log({a:n!==Number(a.lG),chainId:n,CHAINID:Number(a.lG)}),n!==Number(a.lG))throw Error("Please try late~");let r={domain:location.host,chainId:this.chainId,origin:location.origin,issuedAt:new Date().toISOString(),version:"1",nonce:t,statement:e,signType:"EIP-4361",address:c.address};return this.sign(JSON.stringify(r))}async sign(e){let t=JSON.parse(e);console.log({msgData:t});let n="EIP-4361"===t.signType?this.to4361Message({domain:t.domain,chainId:t.chainId||"",uri:t.origin,issuedAt:t.issuedAt,version:t.version,nonce:t.nonce,statement:t.statement,address:t.address}):e,r=await this.provider.request({method:"personal_sign",params:[n,this.address]});return{message:n,signature:r,...t}}to4361Message(e){let{domain:t,version:n,nonce:r,issuedAt:i,statement:s,chainId:a,uri:o,address:c}=e,u=["".concat(t," wants you to sign in with your Ethereum account:"),c].join("\n"),l=r.length,d=r;l<8&&(d="0".repeat(8-l)+r);let h="Nonce: ".concat(d),f=["URI: ".concat(o),"Version: ".concat(n),"Chain ID: "+a,h];f.push("Issued At: ".concat(i));let g=f.join("\n");return u=[u,s].join("\n\n"),s&&(u+="\n"),[u,g].join("\n")}async signByEIP712(e){await this.initAndConnect();let t=await this.provider.request({method:"eth_signTypedData_v4",params:[this.address,e]});return{message:e,signature:t}}async getIdentityByWallet(e){let t=(await c.signByEIP712(JSON.stringify({types:{EIP712Domain:[{name:"name",type:"string"}],Info:[{name:"seed",type:"string"}]},primaryType:"Info",domain:{name:"Secure Note"},message:{seed:e}}))).signature.slice(0,66),n=c.getPublicKey(t);return{privateKey:t,publicKey:n}}constructor(){this.chainId=0,this.address=""}}let c=new o},10621:function(){},56800:function(e,t){var n;/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/!function(){"use strict";var r={}.hasOwnProperty;function i(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=s(e,function(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return i.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var n in e)r.call(e,n)&&e[n]&&(t=s(t,n));return t}(n)))}return e}function s(e,t){return t?e?e+" "+t:e+t:e}e.exports?(i.default=i,e.exports=i):void 0!==(n=(function(){return i}).apply(t,[]))&&(e.exports=n)}()}},function(e){e.O(0,[6900,691,2183,3494,8610,4453,8056,6594,2100,2971,7023,1744],function(){return e(e.s=80496)}),_N_E=e.O()}]);