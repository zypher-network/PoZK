(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2100],{46405:function(t){!function(){"use strict";var e={815:function(t){t.exports=function(t,n,r,o){n=n||"&",r=r||"=";var a={};if("string"!=typeof t||0===t.length)return a;var s=/\+/g;t=t.split(n);var c=1e3;o&&"number"==typeof o.maxKeys&&(c=o.maxKeys);var i=t.length;c>0&&i>c&&(i=c);for(var l=0;l<i;++l){var u,d,f,p,v=t[l].replace(s,"%20"),g=v.indexOf(r);(g>=0?(u=v.substr(0,g),d=v.substr(g+1)):(u=v,d=""),f=decodeURIComponent(u),p=decodeURIComponent(d),Object.prototype.hasOwnProperty.call(a,f))?e(a[f])?a[f].push(p):a[f]=[a[f],p]:a[f]=p}return a};var e=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},577:function(t){var e=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,a,s,c){return(a=a||"&",s=s||"=",null===t&&(t=void 0),"object"==typeof t)?r(o(t),function(o){var c=encodeURIComponent(e(o))+s;return n(t[o])?r(t[o],function(t){return c+encodeURIComponent(e(t))}).join(a):c+encodeURIComponent(e(t[o]))}).join(a):c?encodeURIComponent(e(c))+s+encodeURIComponent(e(t)):""};var n=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function r(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var o=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}}},n={};function r(t){var o=n[t];if(void 0!==o)return o.exports;var a=n[t]={exports:{}},s=!0;try{e[t](a,a.exports,r),s=!1}finally{s&&delete n[t]}return a.exports}r.ab="//";var o={};o.decode=o.parse=r(815),o.encode=o.stringify=r(577),t.exports=o}()},70101:function(t,e,n){"use strict";var r=n(87212),o=n(63536),a=n(2265),s=n(59313),c=n(51356),i=n(72039);e.Z=()=>{let[t,e]=(0,a.useState)(!1),[n,l]=(0,a.useState)(!1),u=(0,c.p)(),{account:d,hasToken:f,loginOut:p}=(0,o.k)(),{address:v,isConnected:g,isDisconnected:h}=(0,r.m)(),{fetch:y}=(0,s.Z)((0,i.N)(t=>({fetch:t.fetch,fetching:t.fetching}))),S=(0,a.useMemo)(()=>{var t,e;return null!==(e=null==d?void 0:d.toLowerCase().startsWith(null!==(t=null==v?void 0:v.toLowerCase())&&void 0!==t?t:""))&&void 0!==e&&e},[v,h]),m=async()=>{try{await y(1),e(!0),l(!0)}catch(t){l(!0),u(t),p()}};return(0,a.useLayoutEffect)(()=>{h||(g&&f&&S?m():(l(!0),p()))},[h,f]),[t,n]}},51356:function(t,e,n){"use strict";n.d(e,{p:function(){return u}});var r=n(57437),o=n(78068),a=n(2265),s=n(99441),c=n(84554),i=n(16463),l=n(63536);let u=()=>{let{toast:t}=(0,o.pm)(),e=(0,i.useRouter)(),n=(0,i.usePathname)(),u=(0,s.Zl)(c.g),{deleteToken:d}=(0,l.k)();return(0,a.useCallback)(async o=>{console.log({error:o});let{code:a,message:s}=o||{};-1===s.indexOf("HTTP error 5")&&t({variant:"destructive",title:null!=a?a:"Failed",description:(0,r.jsx)("p",{className:"text-[14px]",children:null!=s?s:"Failed"})}),"HTTP error 401"===s&&(console.log("8888888888888888888888888888888888888888888888888888888"),d(),u(n),e.push("/"))},[t])}},63536:function(t,e,n){"use strict";n.d(e,{k:function(){return a}});var r=n(2265),o=n(43965);let a=()=>{let t=(0,r.useContext)(o.B);if(!t)throw Error("useSession must be used within a SessionManagerProvider");return t}},43965:function(t,e,n){"use strict";n.d(e,{B:function(){return i}});var r=n(57437),o=n(40431),a=n(78960),s=n(16463),c=n(2265);let i=(0,c.createContext)(void 0);e.default=(0,c.memo)(t=>{let{children:e}=t,n=(0,s.useRouter)(),l=(0,s.usePathname)(),[u,d]=(0,c.useState)(void 0!==o.Z.getSession()),[f,p]=(0,c.useState)(o.Z.getAccount()),v=(0,c.useCallback)(()=>o.Z.getSession(),[]),g=(0,c.useCallback)(t=>{o.Z.setSession(t),d(!0)},[]),h=(0,c.useCallback)(()=>{o.Z.deleteSession(),d(!1)},[]),y=(0,c.useCallback)(async()=>{h(),d(!1),await (0,a.Z)(.2),console.log("---- logout"),"/"!==l&&n.push("/")},[l]);return(0,r.jsx)(i.Provider,{value:{account:f,setAccount:(t,e)=>{o.Z.setAccount("".concat(t).concat(e)),p("".concat(t).concat(e)),d(!0)},hasToken:u,getToken:v,setToken:g,deleteToken:h,loginOut:y},children:e})})},59313:function(t,e,n){"use strict";var r=n(45129);let o=(0,n(39099).Ue)(t=>({controllers:[],active:"",fetching:!1,page:1,fetch:async e=>{t({fetching:!0});try{let n=await r.Z.getControllers(e),o=await r.Z.getActiveController();t({fetching:!1,active:o,controllers:(o?[o]:[]).concat(n.filter(t=>t!==o)).map(t=>({status:t===o?"on":"off",address:t}))})}catch(e){throw t({fetching:!1}),e}}}));e.Z=o},84554:function(t,e,n){"use strict";let r;n.d(e,{g:function(){return a}});var o=n(99441);let a=(0,o.cn)({key:"FailedRoute",default:void 0,effects_UNSTABLE:[(r="FailedRoute",t=>{let{setSelf:e,onSet:n}=t,a=localStorage.getItem(r);if(null!=a)try{e(JSON.parse(a))}catch(t){console.error("localStorageEffect:---",t)}n(t=>{t instanceof o.nY||!t?localStorage.removeItem(r):localStorage.setItem(r,JSON.stringify(t))})})]})},78068:function(t,e,n){"use strict";n.d(e,{Am:function(){return d},pm:function(){return f}});var r=n(2265);let o=0,a=new Map,s=t=>{if(a.has(t))return;let e=setTimeout(()=>{a.delete(t),u({type:"REMOVE_TOAST",toastId:t})},1e3);a.set(t,e)},c=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,1)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(t=>t.id===e.toast.id?{...t,...e.toast}:t)};case"DISMISS_TOAST":{let{toastId:n}=e;return n?s(n):t.toasts.forEach(t=>{s(t.id)}),{...t,toasts:t.toasts.map(t=>t.id===n||void 0===n?{...t,open:!1}:t)}}case"REMOVE_TOAST":if(void 0===e.toastId)return{...t,toasts:[]};return{...t,toasts:t.toasts.filter(t=>t.id!==e.toastId)}}},i=[],l={toasts:[]};function u(t){l=c(l,t),i.forEach(t=>{t(l)})}function d(t){let{...e}=t,n=(o=(o+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>u({type:"DISMISS_TOAST",toastId:n});return u({type:"ADD_TOAST",toast:{...e,id:n,open:!0,duration:2e3,onOpenChange:t=>{t||r()}}}),{id:n,dismiss:r,update:t=>u({type:"UPDATE_TOAST",toast:{...t,id:n}})}}function f(){let[t,e]=r.useState(l);return r.useLayoutEffect(()=>(i.push(e),()=>{let t=i.indexOf(e);t>-1&&i.splice(t,1)}),[t]),{...t,toast:d,dismiss:t=>u({type:"DISMISS_TOAST",toastId:t})}}},44447:function(t,e,n){"use strict";n.d(e,{DJ:function(){return r},ZP:function(){return a},px:function(){return o}}),n(25566).env.metadataBase;let r="Pozk",o="Bearer",a="account-Key"},85090:function(t,e,n){"use strict";var r=n(40431);async function o(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{useUrl:n=!1,...o}=e,a={"Content-Type":"application/json"},s=r.Z.getSession();s&&(a.AUTHORIZATION="Bearer "+s);let c=await fetch("".concat(e.useUrl?"/api":window.location.origin).concat(t),{...o,headers:a});if(!c.ok)throw Error("HTTP error ".concat(c.status));return c.json()}async function a(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o(t,{...e,method:"GET"})}async function s(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return o(t,{...n,method:"POST",body:JSON.stringify(e)})}async function c(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return o(t,{...n,method:"PUT",body:JSON.stringify(e)})}async function i(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o(t,{...e,method:"DELETE"})}e.Z={get:a,post:s,put:c,delete:i}},40431:function(t,e,n){"use strict";var r=n(44447);class o{static getSession(){if(this.isCookie){let t=r.px,e=document.cookie.split(";");for(let n=0;n<e.length;n++){let r=e[n].trim();if(r.startsWith("".concat(t,"=")))return r.substring(t.length+1)}return}let t=localStorage.getItem(r.px);return null!=t?t:void 0}static setSession(t){localStorage.setItem(r.px,t)}static deleteSession(){localStorage.removeItem(r.px)}static getAccount(){let t=localStorage.getItem(r.ZP);return null!=t?t:void 0}static setAccount(t){localStorage.setItem(r.ZP,t)}}o.isCookie=!1,e.Z=o},78960:function(t,e,n){"use strict";function r(t){let e;let n=+new Date;return new Promise((r,o)=>{e=setInterval(()=>{n+1e3*t<+new Date&&(clearInterval(e),r(!0))},10)})}n.d(e,{Z:function(){return r}})},45129:function(t,e,n){"use strict";var r=n(85090),o=n(46405);class a{async getProverContainers(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{var n;let a=(0,o.stringify)({page_count:t,page_size:e}),s=await r.Z.get("".concat(this.endpoints.prover.list,"?").concat(a));return null!==(n=null==s?void 0:s.data)&&void 0!==n?n:[]}catch(t){return this.handleError(t,[])}}async newController(){try{var t;let e=await r.Z.post(this.endpoints.controller.new,{singing_key:null});return console.log(e),null!==(t=null==e?void 0:e.controller)&&void 0!==t?t:""}catch(t){return this.handleError(t,"")}}async getControllers(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=(0,o.stringify)({page_count:t,page_size:e});try{var a;let t=await r.Z.get("".concat(this.endpoints.controller.list,"?").concat(n));return null!==(a=null==t?void 0:t.data)&&void 0!==a?a:[]}catch(t){return this.handleError(t,[])}}async getActiveController(){let t=(0,o.stringify)({page_count:0,page_size:0});try{var e;let n=await r.Z.get("".concat(this.endpoints.controller.list,"?").concat(t));return null!==(e=null==n?void 0:n.main)&&void 0!==e?e:""}catch(t){return this.handleError(t,"")}}async login(t){return await r.Z.post("".concat(this.endpoints.login),t)}async pullProve(t,e,n,o){try{let a={tag:"v".concat(e),name:n,prover:t,overtime:Number(o)};await r.Z.post("".concat(this.endpoints.prover.pull),a)}catch(t){this.handleError(t,"")}}handleError(t,e){let{message:n}=t;if(console.error("catch error:",n,n.includes("500")),n.includes("500"))return e;throw t}constructor(){this.endpoints={login:"/login",proverImage:"/api/provers/{id}",controller:{new:"/api/controllers",list:"/api/controllers"},prover:{list:"/api/provers",pull:"/api/provers"}}}}e.Z=new a},43665:function(t,e,n){"use strict";var r,o;n.d(e,{a_:function(){return r},iF:function(){return s},lG:function(){return a}}),(o=r||(r={})).TESTNET="9901",o.MAINNET="9901";let a="9901",s={9901:{Addresses:"0xfE8595EdE3DA06936f14C14eE7A475490E33a59d",Token:"0x07cb9813aEa7678B70D7Ae418A7d8680E432ea2e",Vesting:"0x81DB6405eDb330D4cBe4B2279397A5677010bD65",Epoch:"0x5393205CdAb1C4f45B045F10c07B29bFf2339b81",Stake:"0xa8c392Fd78fd61292529864873cD42309881903f",Reward:"0x93CF679371fCca140275fd5b974487c87c5bAAAb",Prover:"0x548FF8E93575D24B03d3869038924E47DA0c8c8c",Task:"0x1034E9e24d0baF5329C3cb8E7887c8a4bc488Ce0",Controller:"0xB7779c7af4727A1312fF0d99a0869F155d2F7753"}}}}]);